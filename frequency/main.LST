C51 COMPILER V9.52.0.0   MAIN                                                              08/14/2015 06:51:28 PAGE 1   


C51 COMPILER V9.52.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN main.OBJ
COMPILER INVOKED BY: C:\Program Files\keil\C51\BIN\C51.EXE main.c BROWSE DEBUG OBJECTEXTEND TABS(2)

line level    source

   1          #include <reg51.h>
   2          #include "lcd12864.h"
   3          #include "hc165.h"
   4          /**************************************************************************/
   5          sbit mod1=P1^0;//mod1:frequency , period
   6          sbit mod2=P1^1;//mod2:interval
   7          sbit mod3=P1^2;//mod3:duty
   8          sbit start=P1^3;//send start signal
   9          sbit clr=P1^4;//send clear signal
  10          sbit startout=P2^0;
  11          sbit clrout=P2^1;
  12          bit ready_to_read=0;
  13          bit startflag=0;
  14          bit clrflag=0;
  15          unsigned char keyvalue=0;
  16          unsigned char timercount=0;
  17          extern unsigned char recievedat[16];
  18          /**************************************************************************/
  19          /**************************************************************************/
  20          unsigned char code Photo[]={
  21          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  22          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  23          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  24          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  25          0x00,0x00,0x00,0x00,0x00,0x10,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  26          0x00,0x00,0xDE,0xC0,0x00,0x38,0x00,0x06,0xFF,0x00,0x06,0x00,0x06,0x0C,0x00,0x00,
  27          0x00,0x00,0xFE,0xC0,0x00,0x18,0x00,0x16,0xFF,0x01,0xFF,0xF0,0x07,0x0C,0x00,0x00,
  28          0x00,0x00,0x7D,0xF8,0x07,0xFF,0xC0,0x17,0xB0,0x01,0xFF,0xF0,0x03,0x0C,0x00,0x00,
  29          0x00,0x00,0xFF,0xF8,0x06,0x00,0xC0,0x16,0xFE,0x00,0xCD,0xB0,0x00,0x0C,0x00,0x00,
  30          0x00,0x00,0x7F,0xB0,0x07,0xFF,0xC0,0x3F,0xFE,0x00,0xFF,0xF0,0x0F,0x7F,0xC0,0x00,
  31          0x00,0x00,0xFF,0xB0,0x00,0x0F,0x00,0x3F,0xD6,0x00,0x7F,0x60,0x0F,0x7F,0xC0,0x00,
  32          0x00,0x00,0xBD,0xB0,0x00,0x1C,0x00,0x16,0xD6,0x00,0xFF,0xF0,0x03,0x0C,0x00,0x00,
  33          0x00,0x00,0xFC,0xF0,0x07,0xFF,0xC0,0x1F,0xD6,0x01,0xDF,0xB8,0x03,0x0C,0x00,0x00,
  34          0x00,0x00,0xFC,0xE0,0x07,0xFF,0xC0,0x37,0xD6,0x00,0x06,0x80,0x03,0x0C,0x00,0x00,
  35          0x00,0x00,0xEC,0x60,0x00,0x18,0x00,0x37,0xFE,0x01,0xFF,0xF8,0x03,0x4C,0x00,0x00,
  36          0x00,0x00,0x7D,0xF0,0x00,0x18,0x00,0x2E,0x7C,0x00,0x06,0x00,0x03,0xCC,0x00,0x00,
  37          0x00,0x00,0xFF,0xB8,0x00,0xF8,0x00,0x3D,0xEF,0x00,0x06,0x00,0x03,0x8C,0x00,0x00,
  38          0x00,0x00,0xE3,0x18,0x00,0xF0,0x00,0x39,0x83,0x00,0x06,0x00,0x02,0x0C,0x00,0x00,
  39          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  40          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  41          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  42          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  43          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  44          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  45          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  46          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  47          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  48          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x90,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  49          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x04,0x90,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  50          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x04,0x90,0x02,0x00,0x00,0x00,0x00,0x00,0x00,
  51          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x04,0x90,0x02,0x00,0x00,0x00,0x00,0x00,0x00,
  52          0x00,0x00,0x00,0x00,0x00,0x00,0x40,0x05,0xB0,0x02,0x00,0x00,0x00,0x00,0x00,0x00,
  53          0x00,0x00,0x00,0x00,0x00,0x00,0x41,0x05,0xB0,0x42,0x00,0x00,0x00,0x00,0x00,0x00,
  54          0x00,0x00,0x00,0x00,0x00,0x00,0x41,0x05,0xB0,0x43,0x00,0x00,0x00,0x00,0x00,0x00,
  55          0x00,0x00,0x00,0x00,0x00,0x20,0x41,0x05,0xB0,0x43,0x02,0x00,0x00,0x00,0x00,0x00,
C51 COMPILER V9.52.0.0   MAIN                                                              08/14/2015 06:51:28 PAGE 2   

  56          0x00,0x00,0x00,0x00,0x00,0x20,0x41,0x05,0xB4,0xC3,0x02,0x00,0x00,0x00,0x00,0x00,
  57          0x00,0x00,0x00,0x00,0x08,0x21,0x49,0x0D,0xB6,0xDB,0x86,0x10,0x00,0x00,0x00,0x00,
  58          0x00,0x00,0x00,0x00,0x08,0x21,0x6B,0x0D,0xB6,0xDB,0x86,0x10,0x00,0x00,0x00,0x00,
  59          0x00,0x00,0x00,0x20,0x08,0x61,0x6B,0x0D,0xB6,0xDB,0x86,0x18,0x02,0x00,0x00,0x00,
  60          0x00,0x00,0x00,0x00,0x08,0x61,0x6B,0x0D,0xB6,0xDB,0xC6,0x18,0x00,0x00,0x00,0x00,
  61          0x00,0x00,0x00,0x62,0x1C,0x61,0xEF,0x2D,0xB6,0xDB,0xC6,0x18,0x42,0x00,0x00,0x00,
  62          0x00,0x00,0x00,0x62,0x1C,0x65,0xEF,0xAF,0xF6,0xDB,0xD6,0x18,0x46,0x00,0x00,0x00,
  63          0x00,0x00,0x00,0x72,0x1D,0x65,0xEF,0xEF,0xF6,0xFB,0xD7,0xD8,0x66,0x00,0x00,0x00,
  64          0x00,0x01,0x08,0x53,0x57,0xFD,0xFF,0xEF,0xF6,0xFB,0xF7,0xDF,0x6F,0x18,0x00,0x00,
  65          0x00,0x00,0x59,0x53,0x57,0xFF,0xBE,0xFF,0xFE,0xEB,0xF5,0xDF,0x6B,0x5A,0x08,0x00,
  66          0x00,0x01,0x5D,0x5F,0xF6,0xFF,0xBE,0xFB,0x7F,0xAF,0xFD,0xF7,0xE9,0xDB,0x40,0x00,
  67          0x00,0x01,0x17,0xCF,0xF6,0x9B,0xB6,0xDB,0x7F,0xAF,0xFD,0x75,0xA9,0xDA,0x00,0x00,
  68          0x00,0x00,0x04,0xCD,0xB6,0x1B,0xB6,0xDB,0x6D,0xAD,0xDC,0x25,0xB9,0x50,0x00,0x00,
  69          0x00,0x00,0x00,0x0D,0x86,0x1B,0xB2,0xDB,0x6D,0x2D,0xD8,0x21,0xB0,0x00,0x00,0x00,
  70          0x00,0x00,0x00,0x04,0x86,0x18,0xB0,0xDB,0x69,0x0C,0x88,0x20,0xB0,0x00,0x00,0x00,
  71          0x00,0x00,0x00,0x00,0x86,0x18,0xB0,0xDB,0x69,0x0C,0x88,0x20,0x00,0x00,0x00,0x00,
  72          0x00,0x00,0x00,0x04,0x04,0x18,0xB0,0xDA,0x69,0x0C,0x88,0x00,0x00,0x00,0x00,0x00,
  73          0x00,0x00,0x00,0x00,0x04,0x18,0xB0,0x92,0x49,0x04,0x88,0x00,0x00,0x00,0x00,0x00,
  74          0x00,0x00,0x00,0x00,0x00,0x18,0x30,0x12,0x49,0x04,0x08,0x00,0x00,0x00,0x00,0x00,
  75          0x00,0x00,0x00,0x00,0x00,0x10,0x30,0x12,0x41,0x04,0x00,0x00,0x00,0x00,0x00,0x00,
  76          0x00,0x00,0x00,0x00,0x00,0x00,0x30,0x02,0x40,0x04,0x00,0x00,0x00,0x00,0x00,0x00,
  77          0x00,0x00,0x00,0x00,0x00,0x00,0x20,0x02,0x40,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  78          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x02,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  79          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  80          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  81          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  82          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  83          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  84          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};
  85          unsigned char code show1[]={"模式: "};
  86          unsigned char code show2[]={"周期频率"};
  87          unsigned char code show3[]={"时间间隔"};
  88          unsigned char code show4[]={"占空比  "};
  89          unsigned char code show5[]={"停止测量"};
  90          unsigned char code show6[]={"开始测量"};
  91          unsigned char code unit1[]={"Hz"};
  92          unsigned char code unit2[]={"ms"};
  93          /**************************************************************************/
  94          void Delay10ms(unsigned int c);
  95          void display1(unsigned char k);
  96          void display2(unsigned char k);
  97          void keyscan();
  98          void interrupt2on();
  99          void main()
 100          {
 101   1        LCD12864_DrowPic(&Photo[0]);
 102   1        Delay10ms(1000);  
 103   1        LCD12864_Init();
 104   1        interrupt2on();
 105   1        while(1)
 106   1        {
 107   2          keyscan();
 108   2          display1(keyvalue);
 109   2          display2(keyvalue);
 110   2        }
 111   1      }
 112          void display1(unsigned char k)
 113          {
 114   1        unsigned char i;
 115   1        LCD12864_SetWindow(0,0);
 116   1        for(i=0;show1[i]!='\0';i++)//show1[]={"模式:"};
 117   1        {
C51 COMPILER V9.52.0.0   MAIN                                                              08/14/2015 06:51:28 PAGE 3   

 118   2          LCD12864_WriteData(show1[i]);
 119   2        }
 120   1        switch(k)
 121   1        {
 122   2          case 2:
 123   2          {
 124   3            LCD12864_SetWindow(0,3);
 125   3              for(i=0;show3[i]!='\0';i++)//show3[]={"时间间隔"};
 126   3              {
 127   4                LCD12864_WriteData(show3[i]);
 128   4              }
 129   3          }break;
 130   2          case 3:
 131   2          {
 132   3            LCD12864_SetWindow(0,3);
 133   3              for(i=0;show4[i]!='\0';i++)//show4[]={"占空比"};
 134   3              {
 135   4                LCD12864_WriteData(show4[i]);
 136   4              }
 137   3          }break;
 138   2          default:
 139   2          {
 140   3            LCD12864_SetWindow(0,3);
 141   3              for(i=0;show2[i]!='\0';i++)//show2[]={"周期频率"};
 142   3              {
 143   4                LCD12864_WriteData(show2[i]);
 144   4              }
 145   3          }
 146   2        }
 147   1      }
 148          void display2(unsigned char k)
 149          {
 150   1        unsigned char i;
 151   1        if(startflag)
 152   1        {
 153   2          LCD12864_SetWindow(1,2);
 154   2          for(i=0;show6[i]!='\0';i++)//show5[]={"开始测量"};
 155   2          {
 156   3            LCD12864_WriteData(show6[i]);
 157   3          }
 158   2          switch(k)
 159   2          {
 160   3            case 2:
 161   3            {
 162   4              LCD12864_SetWindow(2,7);
 163   4              for(i=0;unit2[i]!='\0';i++)//unit2[]={"ms"};
 164   4              {
 165   5                LCD12864_WriteData(unit2[i]);
 166   5              }
 167   4              LCD12864_SetWindow(3,7);
 168   4              LCD12864_WriteData(' ');
 169   4              LCD12864_WriteData(' ');
 170   4            }break;
 171   3            case 3:
 172   3            {
 173   4              LCD12864_SetWindow(2,7);
 174   4                LCD12864_WriteData('%');
 175   4              LCD12864_WriteData(' ');
 176   4              LCD12864_SetWindow(3,7);
 177   4              LCD12864_WriteData(' ');
 178   4              LCD12864_WriteData(' ');
 179   4            }break;
C51 COMPILER V9.52.0.0   MAIN                                                              08/14/2015 06:51:28 PAGE 4   

 180   3            default:
 181   3            {
 182   4              LCD12864_SetWindow(2,7);
 183   4              for(i=0;unit1[i]!='\0';i++)//unit1[]={"KHz"};
 184   4              {
 185   5                LCD12864_WriteData(unit1[i]);
 186   5              }
 187   4              LCD12864_SetWindow(3,7);
 188   4              for(i=0;unit2[i]!='\0';i++)//unit2[]={"ms"};
 189   4              {
 190   5                LCD12864_WriteData(unit2[i]);
 191   5              }
 192   4            }
 193   3          }
 194   2        }
 195   1        if(!startflag)
 196   1        {
 197   2          LCD12864_SetWindow(1,2);
 198   2          for(i=0;show5[i]!='\0';i++)//show5[]={"停止测量"};
 199   2          {
 200   3            LCD12864_WriteData(show5[i]);
 201   3          }
 202   2          LCD12864_SetWindow(2,7);
 203   2          LCD12864_WriteData(' ');
 204   2          LCD12864_WriteData(' ');
 205   2          LCD12864_SetWindow(3,7);
 206   2          LCD12864_WriteData(' ');
 207   2          LCD12864_WriteData(' ');
 208   2        }
 209   1      }
 210          void keyscan()
 211          {
 212   1        if(!mod1)
 213   1        {
 214   2          while(!mod1);
 215   2            keyvalue=1;
 216   2        }
 217   1        if(!mod2)
 218   1        {
 219   2          while(!mod2);
 220   2            keyvalue=2;
 221   2        }
 222   1        if(!mod3)
 223   1        {
 224   2          while(!mod3);
 225   2            keyvalue=3;
 226   2        }
 227   1        if(!start)
 228   1        {
 229   2          while(!start);
 230   2            startflag=!startflag;
 231   2            if(startflag)
 232   2            {
 233   3              startout=0;
 234   3              Delay10ms(1);
 235   3              startout=1;
 236   3            }
 237   2        }
 238   1        if(!clr)
 239   1        {
 240   2          while(!clr);
 241   2            clrflag=1;
C51 COMPILER V9.52.0.0   MAIN                                                              08/14/2015 06:51:28 PAGE 5   

 242   2            clrout=0;
 243   2            Delay10ms(1);
 244   2            clrout=1;
 245   2        }
 246   1      }
 247          void interrupt2on()
 248          {
 249   1        EA=1;
 250   1        IT1 = 1;
 251   1        EX1=1;
 252   1      }
 253          void timer ()interrupt 1
 254          {
 255   1        timercount++;
 256   1        if(timercount>=20)
 257   1        {
 258   2          timercount=0;
 259   2        }
 260   1      }
 261          void finish ()interrupt 2
 262          {
 263   1      //  HC165();
 264   1        ready_to_read=1;
 265   1      }
 266          void Delay10ms(unsigned int c)   
 267          {
 268   1          unsigned char a, b;
 269   1      
 270   1          for (;c>0;c--)
 271   1        {
 272   2          for (b=38;b>0;b--)
 273   2          {
 274   3            for (a=130;a>0;a--);
 275   3          }
 276   2                 
 277   2        }        
 278   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    498    ----
   CONSTANT SIZE    =   1082    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      2       4
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      3    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
