C51 COMPILER V7.09   ZLG7290                                                               09/17/2004 11:08:45 PAGE 1   


C51 COMPILER V7.09, COMPILATION OF MODULE ZLG7290
OBJECT MODULE PLACED IN ZLG7290.OBJ
COMPILER INVOKED BY: C:\KEIL\C51\BIN\C51.EXE ZLG7290.C BROWSE DEBUG OBJECTEXTEND

line level    source

   1          /****************************************Copyright (c)**************************************************
   2          **                               广州周立功单片机发展有限公司
   3          **                                     研    究    所
   4          **                                        产品一部 
   5          **
   6          **                                 http://www.zlgmcu.com
   7          **
   8          **--------------文件信息--------------------------------------------------------------------------------
   9          **文   件   名: ZLG7290.C
  10          **创   建   人: 叶皓贲
  11          **最后修改日期:  2003-3-4
  12          **描        述: ZLG7290库函数程序
  13          **
  14          **--------------历史版本信息----------------------------------------------------------------------------
  15          ** 创建人: 叶皓贲
  16          ** 版  本: 0.01
  17          ** 日　期: 2003-3-4
  18          ** 描　述: ZLG7290库函数程序
  19          **
  20          **------------------------------------------------------------------------------------------------------
  21          ** 修改人:
  22          ** 版  本:
  23          ** 日　期:
  24          ** 描　述:
  25          **
  26          **--------------当前版本修订------------------------------------------------------------------------------
  27          ** 修改人: 
  28          ** 日　期:
  29          ** 描　述:
  30          **
  31          **------------------------------------------------------------------------------------------------------
  32          ********************************************************************************************************/
  33          #include "REG52.h"
  34          #include "viic_c51.h"
  35          
  36          #define zlg7290 0x70 //ZLG7290的IIC地址
  37          
  38          #define SubKey  0x01 
  39          #define SubCmdBuf 0x07
  40          #define SubDpRam 0x10
  41          /*********************************************************************************************************
  42          ** 函数名称:    DelayNS
  43          ** 功能描述:    长软件延时
  44          ** 输　入: i :  延时参数，值越大时延时越久
  45          **         
  46          ** 输　出: 无
  47          ** 全局变量:    无
  48          ** 调用模块:    无
  49          **
  50          ** 作　者: 叶皓贲
  51          ** 日　期: 2003-3-4
  52          **-------------------------------------------------------------------------------------------------------
  53          ** 修改人:
  54          ** 日　期:
  55          **------------------------------------------------------------------------------------------------------
C51 COMPILER V7.09   ZLG7290                                                               09/17/2004 11:08:45 PAGE 2   

  56          ********************************************************************************************************/
  57          void delayMS(unsigned char i)
  58          { 
  59   1              unsigned char j,k;
  60   1              for(k=0;k<i;k++)
  61   1                      for(j=0;j<60;j++);
  62   1      }
  63          
  64          /*********************************************************************************************************
  65          ** 函数名称:    ZLG7290_SendData
  66          ** 功能描述:    发送数据
  67          ** 输　入:SubAdd :      输入数据
  68          **       DATA   :       输入值
  69          **         
  70          ** 输　出: 0 ： Fail
  71          **        1 :  OK
  72          ** 全局变量:    无
  73          ** 调用模块:    delayMS
  74          **
  75          ** 作　者: 叶皓贲
  76          ** 日　期: 2003-3-4
  77          **-------------------------------------------------------------------------------------------------------
  78          ** 修改人:
  79          ** 日　期:
  80          **------------------------------------------------------------------------------------------------------
  81          ********************************************************************************************************/
  82          
  83          unsigned char ZLG7290_SendData(unsigned char SubAdd,unsigned char Data)
  84          {
  85   1              if(SubAdd>0x17)
  86   1                      return 0;
  87   1              ISendStr(zlg7290,SubAdd,&Data,1);
  88   1              delayMS(10);
  89   1              return 1;
  90   1      }
  91          /*********************************************************************************************************
  92          ** 函数名称:    ZLG7290_SendCmd
  93          ** 功能描述:    发送命令（对子地址7、8）
  94          ** 输　入:DATA1  :      命令1
  95          **       DATA2  :       命令2
  96          **         
  97          ** 输　出: 0 ： Fail
  98          **        1 :  OK
  99          ** 全局变量:    无
 100          ** 调用模块:    ISendStr、delayMS
 101          **
 102          ** 作　者: 叶皓贲
 103          ** 日　期: 2003-3-4
 104          **-------------------------------------------------------------------------------------------------------
 105          ** 修改人:
 106          ** 日　期:
 107          **------------------------------------------------------------------------------------------------------
 108          ********************************************************************************************************/
 109          
 110          unsigned char ZLG7290_SendCmd(unsigned char Data1,unsigned char Data2)
 111          {
 112   1      unsigned char Data[2];
 113   1              Data[0]=Data1;
 114   1              Data[1]=Data2;
 115   1              ISendStr(zlg7290,0x07,Data,2);
 116   1              delayMS(10);
 117   1              return 1;
C51 COMPILER V7.09   ZLG7290                                                               09/17/2004 11:08:45 PAGE 3   

 118   1      }  
 119          /*********************************************************************************************************
 120          ** 函数名称:    ZLG7290_SendBuf
 121          ** 功能描述:    向显示缓冲区发送数据
 122          ** 输　入: * disp_buf   :       要发送数据的起始地址
 123          **         num          :       发送个数
 124          **         
 125          ** 输　出: 无
 126          ** 全局变量:    无
 127          ** 调用模块:    ZLG7290_SendCmd
 128          **
 129          ** 作　者: 叶皓贲
 130          ** 日　期: 2003-3-4
 131          **-------------------------------------------------------------------------------------------------------
 132          ** 修改人:
 133          ** 日　期:
 134          **------------------------------------------------------------------------------------------------------
 135          ********************************************************************************************************/
 136          void ZLG7290_SendBuf(unsigned char * disp_buf,unsigned char num)
 137          {
 138   1              unsigned char i;
 139   1              for(i=0;i<num;i++)
 140   1              {       
 141   2                      ZLG7290_SendCmd(0x60+i,*disp_buf);
 142   2                      disp_buf++;
 143   2              }
 144   1      }
 145          /*********************************************************************************************************
 146          ** 函数名称:    ZLG7290_GetKey
 147          ** 功能描述:    读取键值
 148          ** 输　入: 无
 149          **         
 150          ** 输　出: >0  键值
 151          **        =0  无键按下
 152          ** 全局变量:    无
 153          ** 调用模块:    IRcvStr、delayMS
 154          **
 155          ** 作　者: 叶皓贲
 156          ** 日　期: 2003-3-4
 157          **-------------------------------------------------------------------------------------------------------
 158          ** 修改人:
 159          ** 日　期:
 160          **------------------------------------------------------------------------------------------------------
 161          ********************************************************************************************************/
 162          
 163          unsigned char   ZLG7290_GetKey()
 164          {
 165   1      unsigned char rece;
 166   1              rece=0;
 167   1              IRcvStr(zlg7290,1,&rece,1);
 168   1              delayMS(10);
 169   1              return rece;
 170   1      }
 171          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    158    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       9
C51 COMPILER V7.09   ZLG7290                                                               09/17/2004 11:08:45 PAGE 4   

   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
